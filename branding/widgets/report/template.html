<div class="rpt-root">
    <div class="rpt-loading">
        <div class="rpt-spinner"></div>
        <div class="rpt-loading-text">Loading report manager...</div>
    </div>

    <div class="rpt-main" style="display:none;">
        <!-- Back Button Header -->
        <div class="rpt-back-header">
            <button class="rpt-back-btn" data-action="back">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                Back to Fleet
            </button>
        </div>

        <!-- Generate Report Section -->
        <div class="rpt-section">
            <div class="rpt-section-header">Generate Report</div>

            <div class="rpt-scope-group">
                <div class="rpt-sub-header">Report Scope</div>
                <div class="rpt-scope-grid">
                    <div class="rpt-field">
                        <label class="rpt-field-label" for="rpt-level">Level</label>
                        <select id="rpt-level" class="rpt-select">
                            <option value="estate">Estate</option>
                            <option value="region">Region</option>
                            <option value="site">Site</option>
                        </select>
                    </div>

                    <div class="rpt-field" id="rpt-estate-row">
                        <label class="rpt-field-label" for="rpt-estate">Estate</label>
                        <select id="rpt-estate" class="rpt-select">
                            <option value="">— Select estate —</option>
                        </select>
                        <span class="rpt-scope-loading rpt-hidden" id="rpt-estate-loading"></span>
                    </div>

                    <div class="rpt-field rpt-hidden" id="rpt-region-row">
                        <label class="rpt-field-label" for="rpt-region">Region</label>
                        <select id="rpt-region" class="rpt-select">
                            <option value="">— Select region —</option>
                        </select>
                        <span class="rpt-scope-loading rpt-hidden" id="rpt-region-loading"></span>
                    </div>

                    <div class="rpt-field rpt-hidden" id="rpt-site-row">
                        <label class="rpt-field-label" for="rpt-site">Site</label>
                        <select id="rpt-site" class="rpt-select">
                            <option value="">— Select site —</option>
                        </select>
                        <span class="rpt-scope-loading rpt-hidden" id="rpt-site-loading"></span>
                    </div>
                </div>
            </div>

            <div class="rpt-period-content-row">
                <div class="rpt-period-group">
                    <div class="rpt-sub-header">Period</div>
                    <div class="rpt-radio-row">
                        <label class="rpt-radio-label">
                            <input type="radio" name="rpt-period" value="last_month" checked> Last Month
                        </label>
                        <label class="rpt-radio-label">
                            <input type="radio" name="rpt-period" value="last_quarter"> Last Quarter
                        </label>
                        <label class="rpt-radio-label">
                            <input type="radio" name="rpt-period" value="last_year"> Last Year
                        </label>
                        <label class="rpt-radio-label">
                            <input type="radio" name="rpt-period" value="custom"> Custom
                        </label>
                    </div>
                    <div class="rpt-custom-dates rpt-hidden" id="rpt-custom-dates">
                        <div class="rpt-date-row">
                            <label class="rpt-field-label" for="rpt-date-start">From</label>
                            <input type="date" id="rpt-date-start" class="rpt-date-input">
                        </div>
                        <div class="rpt-date-row">
                            <label class="rpt-field-label" for="rpt-date-end">To</label>
                            <input type="date" id="rpt-date-end" class="rpt-date-input">
                        </div>
                    </div>
                </div>

                <div class="rpt-content-group">
                    <div class="rpt-sub-header">Report Content</div>
                    <div class="rpt-checkbox-row">
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-section" value="energy" checked> Energy Usage
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-section" value="co2" checked> CO₂ Emissions
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-section" value="faults" checked> Fault Log
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-section" value="summary" checked> Site Summary
                        </label>
                    </div>
                </div>
            </div>

            <div class="rpt-recipients-group">
                <div class="rpt-sub-header">Recipients</div>
                <textarea id="rpt-emails" class="rpt-textarea" rows="2"
                    placeholder="Enter email addresses, one per line"></textarea>
            </div>

            <div class="rpt-btn-row">
                <button type="button" id="rpt-gen-only" class="rpt-btn rpt-btn-secondary">Generate Only</button>
                <button type="button" id="rpt-gen-email" class="rpt-btn rpt-btn-primary">Generate &amp; Email</button>
                <span class="rpt-gen-spinner rpt-hidden" id="rpt-gen-spinner"></span>
            </div>

            <div class="rpt-result rpt-hidden" id="rpt-result">
                <span class="rpt-result-message" id="rpt-result-message"></span>
                <a class="rpt-result-download rpt-hidden" id="rpt-result-download" href="#" target="_blank">Download PDF</a>
            </div>
        </div>

        <!-- Scheduled Reports Section -->
        <div class="rpt-section" id="rpt-schedule-section">
            <div class="rpt-section-header">Scheduled Reports</div>

            <div class="rpt-schedule-form">
                <div class="rpt-sub-header">Schedule Configuration</div>
                <div class="rpt-sched-row">
                    <div class="rpt-sched-field">
                        <label class="rpt-field-label" for="rpt-sched-freq">Frequency</label>
                        <select id="rpt-sched-freq" class="rpt-select">
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                    <div class="rpt-sched-field">
                        <label class="rpt-field-label" for="rpt-sched-day">Day</label>
                        <select id="rpt-sched-day" class="rpt-select">
                            <!-- Options 1-28, populated by JS -->
                        </select>
                    </div>
                    <div class="rpt-sched-field">
                        <label class="rpt-field-label" for="rpt-sched-time">Time UTC</label>
                        <input type="time" id="rpt-sched-time" class="rpt-date-input" value="06:00">
                    </div>
                </div>

                <div class="rpt-content-group">
                    <div class="rpt-sub-header">Content</div>
                    <div class="rpt-checkbox-row">
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-sched-section" value="energy" checked> Energy Usage
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-sched-section" value="co2" checked> CO₂ Emissions
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-sched-section" value="faults" checked> Fault Log
                        </label>
                        <label class="rpt-checkbox-label">
                            <input type="checkbox" name="rpt-sched-section" value="summary" checked> Site Summary
                        </label>
                    </div>
                </div>

                <div class="rpt-recipients-group">
                    <div class="rpt-sub-header">Recipients</div>
                    <textarea id="rpt-sched-emails" class="rpt-textarea" rows="2"
                        placeholder="Enter email addresses, one per line"></textarea>
                </div>
            </div>

            <div class="rpt-sched-status" id="rpt-sched-status">
                <span id="rpt-sched-status-text">No schedule configured</span>
            </div>

            <div class="rpt-btn-row" id="rpt-sched-btn-row">
                <button type="button" id="rpt-sched-save" class="rpt-btn rpt-btn-primary">Save Schedule</button>
                <button type="button" id="rpt-sched-disable" class="rpt-btn rpt-btn-secondary rpt-hidden">Disable</button>
                <button type="button" id="rpt-sched-delete" class="rpt-btn rpt-btn-danger rpt-hidden">Delete</button>
                <span class="rpt-gen-spinner rpt-hidden" id="rpt-sched-spinner"></span>
            </div>
        </div>

        <!-- Report History Section -->
        <div class="rpt-section" id="rpt-history-section">
            <div class="rpt-section-header">Report History</div>
            <div id="rpt-history-content">
                <div class="rpt-empty" id="rpt-history-empty">No reports generated yet.</div>
                <table class="rpt-table rpt-hidden" id="rpt-history-table">
                    <thead>
                        <tr>
                            <th>Date</th><th>Period</th><th>Status</th><th>Size</th><th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="rpt-history-body"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
